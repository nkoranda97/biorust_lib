#[derive(Clone, Copy, Debug)]
pub struct MatrixDef {
    pub name: &'static str,
    pub alphabet: &'static [u8],
    pub scores: &'static [i16],
}

pub const EDNAFULL_ALPHABET: &[u8] = b"ATGCSWRYKMBVHDN";
pub const BLOSUM62_ALPHABET: &[u8] = b"ARNDCQEGHILKMFPSTWYVBZX*";

pub const EDNAFULL: [i16; 225] = [
    5, -4, -4, -4, -4, 1, 1, -4, -4, 1, -4, -1, -1, -1, -2, // A
    -4, 5, -4, -4, -4, 1, -4, 1, 1, -4, -1, -4, -1, -1, -2, // T
    -4, -4, 5, -4, 1, -4, 1, -4, 1, -4, -1, -1, -4, -1, -2, // G
    -4, -4, -4, 5, 1, -4, -4, 1, -4, 1, -1, -1, -1, -4, -2, // C
    -4, -4, 1, 1, -1, -4, -2, -2, -2, -2, -1, -1, -3, -3, -1, // S
    1, 1, -4, -4, -4, -1, -2, -2, -2, -2, -3, -3, -1, -1, -1, // W
    1, -4, 1, -4, -2, -2, -1, -4, -2, -2, -3, -1, -3, -1, -1, // R
    -4, 1, -4, 1, -2, -2, -4, -1, -2, -2, -1, -3, -1, -3, -1, // Y
    -4, 1, 1, -4, -2, -2, -2, -2, -1, -4, -1, -3, -3, -1, -1, // K
    1, -4, -4, 1, -2, -2, -2, -2, -4, -1, -3, -1, -1, -3, -1, // M
    -4, -1, -1, -1, -1, -3, -3, -1, -1, -3, -1, -2, -2, -2, -1, // B
    -1, -4, -1, -1, -1, -3, -1, -3, -3, -1, -2, -1, -2, -2, -1, // V
    -1, -1, -4, -1, -3, -1, -3, -1, -3, -1, -2, -2, -1, -2, -1, // H
    -1, -1, -1, -4, -3, -1, -1, -3, -1, -3, -2, -2, -2, -1, -1, // D
    -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, // N
];

pub static EDNAFULL_DEF: MatrixDef = MatrixDef {
    name: "EDNAFULL",
    alphabet: EDNAFULL_ALPHABET,
    scores: &EDNAFULL,
};

pub const BLOSUM62: [i16; 576] = [
    4, -1, -2, -2, 0, -1, -1, 0, -2, -1, -1, -1, -1, -2, -1, 1, 0, -3, -2, 0, -2, -1, 0,
    -4, // A
    -1, 5, 0, -2, -3, 1, 0, -2, 0, -3, -2, 2, -1, -3, -2, -1, -1, -3, -2, -3, -1, 0, -1,
    -4, // R
    -2, 0, 6, 1, -3, 0, 0, 0, 1, -3, -3, 0, -2, -3, -2, 1, 0, -4, -2, -3, 3, 0, -1, -4, // N
    -2, -2, 1, 6, -3, 0, 2, -1, -1, -3, -4, -1, -3, -3, -1, 0, -1, -4, -3, -3, 4, 1, -1,
    -4, // D
    0, -3, -3, -3, 9, -3, -4, -3, -3, -1, -1, -3, -1, -2, -3, -1, -1, -2, -2, -1, -3, -3, -2,
    -4, // C
    -1, 1, 0, 0, -3, 5, 2, -2, 0, -3, -2, 1, 0, -3, -1, 0, -1, -2, -1, -2, 0, 3, -1, -4, // Q
    -1, 0, 0, 2, -4, 2, 5, -2, 0, -3, -3, 1, -2, -3, -1, 0, -1, -3, -2, -2, 1, 4, -1, -4, // E
    0, -2, 0, -1, -3, -2, -2, 6, -2, -4, -4, -2, -3, -3, -2, 0, -2, -2, -3, -3, -1, -2, -1,
    -4, // G
    -2, 0, 1, -1, -3, 0, 0, -2, 8, -3, -3, -1, -2, -1, -2, -1, -2, -2, 2, -3, 0, 0, -1,
    -4, // H
    -1, -3, -3, -3, -1, -3, -3, -4, -3, 4, 2, -3, 1, 0, -3, -2, -1, -3, -1, 3, -3, -3, -1,
    -4, // I
    -1, -2, -3, -4, -1, -2, -3, -4, -3, 2, 4, -2, 2, 0, -3, -2, -1, -2, -1, 1, -4, -3, -1,
    -4, // L
    -1, 2, 0, -1, -3, 1, 1, -2, -1, -3, -2, 5, -1, -3, -1, 0, -1, -3, -2, -2, 0, 1, -1,
    -4, // K
    -1, -1, -2, -3, -1, 0, -2, -3, -2, 1, 2, -1, 5, 0, -2, -1, -1, -1, -1, 1, -3, -1, -1,
    -4, // M
    -2, -3, -3, -3, -2, -3, -3, -3, -1, 0, 0, -3, 0, 6, -4, -2, -2, 1, 3, -1, -3, -3, -1,
    -4, // F
    -1, -2, -2, -1, -3, -1, -1, -2, -2, -3, -3, -1, -2, -4, 7, -1, -1, -4, -3, -2, -2, -1, -2,
    -4, // P
    1, -1, 1, 0, -1, 0, 0, 0, -1, -2, -2, 0, -1, -2, -1, 4, 1, -3, -2, -2, 0, 0, 0, -4, // S
    0, -1, 0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -1, 1, 5, -2, -2, 0, -1, -1, 0,
    -4, // T
    -3, -3, -4, -4, -2, -2, -3, -2, -2, -3, -2, -3, -1, 1, -4, -3, -2, 11, 2, -3, -4, -3, -2,
    -4, // W
    -2, -2, -2, -3, -2, -1, -2, -3, 2, -1, -1, -2, -1, 3, -3, -2, -2, 2, 7, -1, -3, -2, -1,
    -4, // Y
    0, -3, -3, -3, -1, -2, -2, -3, -3, 3, 1, -2, 1, -1, -2, -2, 0, -3, -1, 4, -3, -2, -1,
    -4, // V
    -2, -1, 3, 4, -3, 0, 1, -1, 0, -3, -4, 0, -3, -3, -2, 0, -1, -4, -3, -3, 4, 1, -1,
    -4, // B
    -1, 0, 0, 1, -3, 3, 4, -2, 0, -3, -3, 1, -1, -3, -1, 0, -1, -3, -2, -2, 1, 4, -1, -4, // Z
    0, -1, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, 0, 0, -2, -1, -1, -1, -1, -1,
    -4, // X
    -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4,
    1, // *
];

pub static BLOSUM62_DEF: MatrixDef = MatrixDef {
    name: "BLOSUM62",
    alphabet: BLOSUM62_ALPHABET,
    scores: &BLOSUM62,
};

pub fn matrix_by_name(name: &str) -> Option<&'static MatrixDef> {
    let upper = name.trim().to_ascii_uppercase();
    match upper.as_str() {
        "EDNAFULL" => Some(&EDNAFULL_DEF),
        "BLOSUM62" => Some(&BLOSUM62_DEF),
        _ => None,
    }
}

pub fn matrix_names() -> &'static [&'static str] {
    &["EDNAFULL", "BLOSUM62"]
}
